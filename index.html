<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KEIPL Container Marking Report</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @media print {
            .no-print { display: none !important; }
            body { background: white; padding: 0; }
            table { border-collapse: collapse; width: 100%; }
            th, td { border: 1px solid #000 !important; padding: 4px; font-size: 9px; }
            .print-photo { width: 70px; height: 70px; object-fit: cover; }
        }
        .table-outline { border: 2px solid #000; }
    </style>
</head>
<body class="bg-slate-100 text-slate-900">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo } = React;

        function App() {
            const [header, setHeader] = useState({
                marker: '', supervisor: '', container: '', factory: '', dest: '', colour: ''
            });
            const [entries, setEntries] = useState([]);
            const [current, setCurrent] = useState({ gL: '', gW: '', nL: '', nW: '', photo: null });

            const handlePhoto = (e) => {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onloadend = () => setCurrent(prev => ({ ...prev, photo: reader.result }));
                    reader.readAsDataURL(file);
                }
            };

            const addSlab = () => {
                if (!current.gL || !current.gW) return alert("Please enter Gross Dimensions");
                
                const now = new Date();
                const timestamp = now.toLocaleDateString() + ' ' + now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});

                const newSlab = {
                    ...current,
                    id: Date.now(),
                    slabNo: `KEIPL/${entries.length + 1}`,
                    gSqm: ((current.gL * current.gW) / 10000).toFixed(3),
                    nSqm: ((current.nL * current.nW) / 10000).toFixed(3),
                    time: timestamp
                };
                setEntries([...entries, newSlab]);
                setCurrent({ gL: '', gW: '', nL: '', nW: '', photo: null });
                document.getElementById('file-upload').value = "";
            };

            const totals = useMemo(() => ({
                g: entries.reduce((s, e) => s + parseFloat(e.gSqm), 0).toFixed(3),
                n: entries.reduce((s, e) => s + parseFloat(e.nSqm), 0).toFixed(3)
            }), [entries]);

            return (
                <div className="max-w-6xl mx-auto p-4 md:p-8 print:p-0">
                    {/* TOP HEADER SECTION */}
                    <div className="bg-white border-2 border-black p-6 mb-4 rounded-none shadow-sm">
                        <div className="flex justify-between items-start border-b-2 border-black pb-4 mb-4">
                            <div>
                                <h1 className="text-2xl font-black uppercase">KEIPL Inspection Report</h1>
                                <p className="text-xs font-bold text-slate-500 tracking-widest">Slab Level Measurement Data</p>
                            </div>
                            <button onClick={() => window.print()} className="no-print bg-blue-600 text-white px-6 py-2 rounded font-bold shadow-lg">PRINT PDF</button>
                        </div>
                        <div className="grid grid-cols-2 md:grid-cols-3 gap-y-4 gap-x-12">
                            {[ ['Marker Name', 'marker'], ['Supervisor', 'supervisor'], ['Container No', 'container'], ['Factory Name', 'factory'], ['Destination', 'dest'], ['Colour', 'colour'] ].map(([label, key]) => (
                                <div key={key} className="border-b border-slate-300">
                                    <label className="block text-[10px] uppercase font-bold text-slate-500">{label}</label>
                                    <input className="w-full font-bold outline-none bg-transparent py-1" value={header[key]} onChange={e => setHeader({...header, [key]: e.target.value})} placeholder="..." />
                                </div>
                            ))}
                        </div>
                    </div>

                    {/* ENTRY FORM */}
                    <div className="no-print bg-slate-900 text-white p-6 rounded-xl mb-6 border-l-8 border-blue-500 shadow-xl">
                        <div className="grid grid-cols-1 md:grid-cols-4 gap-6">
                            <div className="md:col-span-2 grid grid-cols-2 gap-4">
                                <div>
                                    <label className="block text-[10px] text-slate-400 uppercase font-bold mb-1">Gross (L x W)</label>
                                    <div className="flex gap-1">
                                        <input type="number" placeholder="L" className="w-full p-2 text-black rounded font-bold" value={current.gL} onChange={e => setCurrent({...current, gL: e.target.value, nL: e.target.value})} />
                                        <input type="number" placeholder="W" className="w-full p-2 text-black rounded font-bold" value={current.gW} onChange={e => setCurrent({...current, gW: e.target.value, nW: e.target.value})} />
                                    </div>
                                </div>
                                <div>
                                    <label className="block text-[10px] text-green-400 uppercase font-bold mb-1">Net (L x W)</label>
                                    <div className="flex gap-1">
                                        <input type="number" placeholder="L" className="w-full p-2 text-black rounded bg-green-50 font-bold" value={current.nL} onChange={e => setCurrent({...current, nL: e.target.value})} />
                                        <input type="number" placeholder="W" className="w-full p-2 text-black rounded bg-green-50 font-bold" value={current.nW} onChange={e => setCurrent({...current, nW: e.target.value})} />
                                    </div>
                                </div>
                            </div>

                            <div className="space-y-2">
                                <label className="block text-[10px] text-blue-400 uppercase font-bold">Step 1: Camera or Gallery</label>
                                <input id="file-upload" type="file" accept="image/*" onChange={handlePhoto} 
                                    className="block w-full text-xs text-slate-400 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-600 file:text-white hover:file:bg-blue-500 cursor-pointer" 
                                />
                                {current.photo && <div className="text-[10px] text-green-400 font-bold flex items-center gap-1">✓ Photo Selected <img src={current.photo} className="h-6 w-6 rounded border border-white" /></div>}
                            </div>

                            <div className="flex items-end">
                                <button onClick={addSlab} className="w-full bg-green-600 hover:bg-green-500 text-white font-black py-4 rounded-lg uppercase tracking-widest transition-all shadow-lg">
                                    Step 2: Add Slab
                                </button>
                            </div>
                        </div>
                    </div>

                    {/* DATA TABLE */}
                    <div className="bg-white table-outline overflow-hidden shadow-sm">
                        <table className="w-full border-collapse">
                            <thead className="bg-slate-100 border-b-2 border-black">
                                <tr>
                                    <th className="p-2 text-left w-10 text-[8px]">S.No</th>
                                    <th className="p-2 text-left text-[10px]">Slab ID</th>
                                    <th className="p-2 text-center text-[10px]">Photo</th>
                                    <th className="p-2 text-center text-[10px]">Gross (cm)</th>
                                    <th className="p-2 text-center text-[10px] bg-blue-50">Gross SQM</th>
                                    <th className="p-2 text-center text-[10px]">Net (cm)</th>
                                    <th className="p-2 text-center text-[10px] bg-green-50">Net SQM</th>
                                    <th className="p-2 text-right text-[8px]">Date/Time</th>
                                    <th className="p-2 text-center no-print text-[10px]">Action</th>
                                </tr>
                            </thead>
                            <tbody className="divide-y divide-slate-300">
                                {entries.map((e, i) => (
                                    <tr key={e.id} className="print:break-inside-avoid">
                                        <td className="p-2 text-slate-400 text-[9px]">{i + 1}</td>
                                        <td className="p-2 font-black text-xs">{e.slabNo}</td>
                                        <td className="p-2 text-center">
                                            {e.photo ? <img src={e.photo} className="h-16 w-16 mx-auto object-cover border border-black print-photo" /> : <span className="text-[7px] text-slate-300 uppercase">N/A</span>}
                                        </td>
                                        <td className="p-2 text-center text-xs">{e.gL}×{e.gW}</td>
                                        <td className="p-2 text-center font-bold text-xs bg-blue-50/30">{e.gSqm}</td>
                                        <td className="p-2 text-center text-xs">{e.nL}×{e.nW}</td>
                                        <td className="p-2 text-center font-bold text-xs text-green-700 bg-green-50/30">{e.nSqm}</td>
                                        <td className="p-2 text-right text-[7px] font-mono text-slate-500 uppercase">{e.time}</td>
                                        <td className="p-2 text-center no-print">
                                            <button onClick={() => setEntries(entries.filter(x => x.id !== e.id))} className="text-red-500 font-bold text-[10px] hover:bg-red-50 p-1 rounded">Delete</button>
                                        </td>
                                    </tr>
                                ))}
                            </tbody>
                            <tfoot className="border-t-2 border-black bg-slate-50 font-black">
                                <tr className="text-[10px]">
                                    <td colSpan="4" className="p-4 text-right uppercase tracking-tighter">Grand Total SQM:</td>
                                    <td className="p-4 text-center border-x border-black text-blue-800 text-xs">{totals.g}</td>
                                    <td></td>
                                    <td className="p-4 text-center border-x border-black text-green-800 text-xs">{totals.n}</td>
                                    <td colSpan="2"></td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                    
                    {/* SIGNATURE SECTION (For Printed Reports) */}
                    <div className="mt-12 hidden print:grid grid-cols-2 gap-20">
                        <div className="border-t border-black pt-2 text-center">
                            <p className="text-[10px] font-bold uppercase">Supervisor Signature</p>
                        </div>
                        <div className="border-t border-black pt-2 text-center">
                            <p className="text-[10px] font-bold uppercase">Factory Representative</p>
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
